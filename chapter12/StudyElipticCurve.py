# 楕円曲線（Elliptic Curve）の実数平面上の形を等高線（contour）で描くコード
# -----------------------------------------------------------------------------
# 目的
# - 楕円曲線の典型形（Weierstrass 形式）
#
#     y^2 = x^3 + ax + b
#
# の「実数解の集合」を 2 次元平面上に描画する。
#
# このコードでは式を
#   z(x,y) = y^2 - x^3 + 3x - 4
# と置き、
#   z(x,y) = 0
# の等高線を描くことで
#
#   y^2 - x^3 + 3x - 4 = 0
#   <=> y^2 = x^3 - 3x + 4
#
# という曲線の形を可視化している。
#
# -----------------------------------------------------------------------------
# 暗号理論との関係
# -----------------------------------------------------------------------------
# - 楕円曲線暗号（ECC）では有限体（mod p）上の点集合を扱うが、
#   まず実数上での “幾何的な形” を見ると理解の助けになる。
# - 有限体上では点が離散的に並ぶが、式の構造は同じ（y^2 = x^3 + ax + b）。
#
# -----------------------------------------------------------------------------
# この描画手法（contour の意味）
# -----------------------------------------------------------------------------
# - `plt.contour(X, Y, Z, [0])` は「Z=0 の等高線」を描く。
# - ここでは Z = y^2 - x^3 + 3x - 4 なので、
#   Z=0 が楕円曲線そのものの点集合（実数解）になる。
#
# -----------------------------------------------------------------------------
# 実装のポイント
# -----------------------------------------------------------------------------
# 1) x, y の範囲を格子（grid）として作る
# 2) 格子上で z(x,y) を計算する
# 3) z=0 の等高線を描く
# 4) アスペクト比を 1:1 にして歪みを防ぐ
# 5) EPS 形式で保存してから表示する


import matplotlib.pyplot as plt
import numpy as np

# -----------------------------------------------------------------------------
# 1) 描画する範囲（格子点の生成）
# -----------------------------------------------------------------------------
# x の範囲：-2.5 から 3.5 まで、刻み 0.05
Ranx = np.arange(-2.5, 3.5, 0.05)

# y の範囲：-3 から 3 まで、刻み 0.05
Rany = np.arange(-3, 3, 0.05)

# meshgrid により、(x,y) の 2次元格子を作る
# - x, y はそれぞれ同じ形の2次元配列になり、
#   各要素 (x[i,j], y[i,j]) が平面上の格子点を表す。
x, y = np.meshgrid(Ranx, Rany)

# -----------------------------------------------------------------------------
# 2) 表示範囲とアスペクト比（縦横比）を調整
# -----------------------------------------------------------------------------
# axis([xmin, xmax, ymin, ymax]) で表示範囲を固定
plt.axis([-3, 3.5, -3, 3])

# 座標の縦横比を等しくする（歪みを防ぐ）
# これをしないと、曲線が縦長/横長に見えて形の理解を誤りやすい。
plt.gca().set_aspect('equal', adjustable='box')

# -----------------------------------------------------------------------------
# 3) 楕円曲線を z=0 の等高線として定義
# -----------------------------------------------------------------------------
# z = y^2 - x^3 + 3x - 4
#
# z=0 は
#   y^2 - x^3 + 3x - 4 = 0
# <=> y^2 = x^3 - 3x + 4
#
# これは Weierstrass 形式 y^2 = x^3 + ax + b において
#   a = -3,  b = 4
# に対応する。
#
# コメントの別案：
#   # z = y**2 - x**3 + 3*x - 1
# とすると b が 1 になり、曲線の形（実数解の枝の数など）が変化する。
z = y**2 - x**3 + 3*x - 4

# -----------------------------------------------------------------------------
# 4) 等高線（z=0）を描画
# -----------------------------------------------------------------------------
# contour の第4引数 [0] は「レベル0（z=0）の線だけ描く」指定。
# これにより “方程式の解集合” である曲線そのものが描かれる。
plt.contour(x, y, z, [0])

# -----------------------------------------------------------------------------
# 5) ファイル保存と表示
# -----------------------------------------------------------------------------
# EPS（Encapsulated PostScript）はベクタ形式なので、
# 論文やレポート向けに綺麗に拡大縮小できる。
plt.savefig('EC3Answer1.eps')

# 画面表示
plt.show()
