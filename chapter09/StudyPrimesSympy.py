# SymPy を使った「素数」関連の基本操作デモ
# -----------------------------------------------------------------------------
# 目的
# - 暗号理論（RSA など）で重要になる「素数」「素数分布」「素因数分解」などを、
#   Python の数式処理ライブラリ SymPy で手軽に試すための最小例である。
#
# SymPy（sympy）とは
# - Python のシンボリック計算（数式処理）ライブラリ。
# - 整数論（number theory）系の関数が豊富で、素数・因数分解・合同式などを扱える。
#
# 注意（実務/暗号用途の観点）
# - SymPy の関数は「数学・教育・研究」用途として便利だが、
#   高速性や一定時間性（サイドチャネル耐性）を要求する暗号実装用途にはそのまま適さない場合がある。
# - ただし「素数や因数分解の挙動を理解する」には非常に有用。


import sympy

# -----------------------------------------------------------------------------
# 1) n 番目の素数を求める：sympy.prime(n)
# -----------------------------------------------------------------------------
# sympy.prime(n) は「n 番目の素数」を返す。
# - 1番目 = 2
# - 2番目 = 3
# - 3番目 = 5
# ...
#
# ここでは 1000 番目の素数を求める。
# これは「素数列のインデックスアクセス」に相当。
print(sympy.prime(1000))  # 1000th prime

# -----------------------------------------------------------------------------
# 2) π(x) = x 以下の素数の個数：sympy.primepi(x)
# -----------------------------------------------------------------------------
# primepi(x) は「素数計数関数 π(x)」を返す。
# つまり、x 以下に素数が何個あるかを数える。
#
# 例: primepi(10) = 4（2,3,5,7）
#
# ここでは x=1000 に対して π(1000) を求める。
# 「1000以下の素数が何個あるか」が分かる。
print(sympy.primepi(1000))  # number of primes <= 1000

# -----------------------------------------------------------------------------
# 3) 素数判定：sympy.isprime(n)
# -----------------------------------------------------------------------------
# isprime(n) は n が素数かどうかを True/False で返す。
# 内部では確率的テスト＋必要に応じて決定的チェックなど、
# サイズに応じた効率的な手法が使われる（詳細はSymPy側実装）。
#
# ここでは 257 が素数かを判定する。
# 257 は有名なフェルマー数 F3 = 2^(2^3) + 1 で、実際に素数である。
print(sympy.isprime(257))  # primality test

# -----------------------------------------------------------------------------
# 4) 区間内の素数列挙：sympy.primerange(a, b)
# -----------------------------------------------------------------------------
# primerange(a, b) は区間 [a, b)（a以上 b未満）の素数を順に生成するイテレータ。
# list(...) で具体的なリストとして取り出せる。
#
# ここでは [100, 200) に含まれる素数一覧を作る。
print(list(sympy.primerange(100, 200)))  # list of primes in [100, 200)

# -----------------------------------------------------------------------------
# 5) 素因数分解：sympy.factorint(n)
# -----------------------------------------------------------------------------
# factorint(n) は n の素因数分解を辞書形式で返す。
# 戻り値は
#   {p1: e1, p2: e2, ...}
# の形で、n = Π p_i^{e_i} を意味する。
#
# 例: 12 -> {2: 2, 3: 1} （12 = 2^2 * 3）
#
# ここでは 7824 の素因数分解を求める。
# 暗号（RSA）の文脈では「大きい合成数の素因数分解が難しい」ことが安全性の鍵になるが、
# この例は小さいので即座に分解できる。
print(sympy.factorint(7824))  # factorization of 7824
