# hashlib を用いた SHA-256 ハッシュ計算の最小例
# -----------------------------------------------------------------------------
# このコードは、与えられたメッセージ（バイト列）に対して
# SHA-256（Secure Hash Algorithm 256-bit）を適用し、
# そのダイジェスト（ハッシュ値）を 16進文字列で表示する。
#
# -----------------------------------------------------------------------------
# 1. ハッシュ関数とは（暗号理論の観点）
# -----------------------------------------------------------------------------
# 暗号学的ハッシュ関数 H は、任意長の入力 m（メッセージ）を固定長の出力 h に写像する。
# SHA-256 の場合、出力は 256bit（=32バイト）である。
#
# 期待される性質（理想モデル的には）
# - 一方向性（preimage resistance）:
#     与えられたハッシュ値 h から、それを与える入力 m を見つけるのが困難
# - 第二原像困難性（second-preimage resistance）:
#     ある入力 m に対して H(m)=H(m') となる別の m' を見つけるのが困難
# - 衝突困難性（collision resistance）:
#     H(m)=H(m') となる異なる2つの入力組 (m,m') を見つけるのが困難
#
# SHA-256 の「衝突困難性」の理想的な強度はバースデー限界からおよそ 2^(256/2)=2^128 。
#
# -----------------------------------------------------------------------------
# 2. hashlib とは（ライブラリの観点）
# -----------------------------------------------------------------------------
# Python 標準ライブラリ hashlib は、SHA-256 を含む各種ハッシュ関数の実装を提供する。
# 代表:
# - hashlib.sha256
# - hashlib.sha1（暗号用途としては非推奨）
# - hashlib.md5（暗号用途としては非推奨）
#
# hashlib.sha256(data) は、data（bytes）を入力としてハッシュオブジェクトを作る。
# その後
# - digest()    : 32バイトの生バイナリを返す
# - hexdigest() : digest() を 16進文字列（64文字）で返す
#
# -----------------------------------------------------------------------------
# 3. 実装上のポイント
# -----------------------------------------------------------------------------
# - 入力を b"..." としているのは「bytes リテラル」であるため。
#   hashlib は bytes-like object を入力に要求する。
#   もし str を入力したい場合は、text.encode("utf-8") のように bytes 化する必要がある。
#
# - hexdigest() は表示に便利だが、暗号処理で生のバイト列が必要なら digest() を使う。


import hashlib  # Python標準のハッシュ関数ライブラリ

# -----------------------------------------------------------------------------
# SHA-256 の計算
# -----------------------------------------------------------------------------
# 入力メッセージ（bytes）
msg = b"A chain is no stronger than its weakest link."

# sha256(msg) でハッシュオブジェクトを作成し、hexdigest() で 16進文字列へ変換
# - SHA-256 の出力は 32バイトなので、hexdigest は 64文字になる（1バイト=2桁16進）
h = hashlib.sha256(msg).hexdigest()

# 結果を表示
print(h)

# -----------------------------------------------------------------------------
# 追加メモ（学習上の注意）
# -----------------------------------------------------------------------------
# - 「パスワード保存」目的で sha256(password) をそのまま使うのは推奨されない。
#   実務では salt + ストレッチング（PBKDF2 / bcrypt / scrypt / Argon2 等）を使う。
# - 「改ざん検知」目的で鍵付きハッシュが必要なら、単なる sha256 ではなく HMAC を使う。
#   Python では hmac モジュール（hmac.new(key, msg, hashlib.sha256)）が定石。
